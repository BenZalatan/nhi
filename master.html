<!--Version: 7 // Please raise the number every time you make an edit-->
<!--Last Edited By: Anna Thomas // Change to your name after every edit-->
<html>
    <head>
        <title>Unified Code</title>

        <!--Dependencies-->
        <script src="pixi.min.js"></script>
        <script src="globalVariables.js"></script>
        <link rel="stylesheet" href="masterStyleSheet.css">

        <!--Login Dependencies-->
        <script src="Login/login.js"></script>
        <script src="Login/captionFactory.js"></script>
        
        <!--Windows Dependencies-->
        <script src="Windows/main.js"></script>
        <script src="Windows/makeBg.js"></script>
        <script src="Windows/drawHex.js"></script>
        <script src="Windows/drawInfoBox.js"></script>
        
        <!--Spectrum Imaging Dependencies-->
        <script src="Spectrum_Imaging/spectrum.js"></script>
        
        <!--Tilting Dependencies-->
        <script src="Tilting/tilting.js"></script>
  
        <!--Multi-block Dependencies-->
        <script src="Multi-block/boxInformation.js"></script>
        <script src="Multi-block/createButton.js"></script>
        <script src="Multi-block/moveAroundCanvas.js"></script>
        <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="Multi-block/main.js"></script>
  
        <!--Line Integral Dependencies-->
        <script src="Line_Intensity/text_styles.js"></script>
        <script src="Line_Intensity/line_intensity_file.js"></script>
        <script src="Line_Intensity/edited_graphs.js"></script>
        <script src="Line_Intensity/bring_to_front.js"></script>
        <script src="Line_Intensity/change_text.js"></script>
        <script src="Line_Intensity/graphs.js"></script>
        <script src="Line_Intensity/line.js"></script>
        <script src="Line_Intensity/point.js"></script>
        
        <!-- Low Magnification Screening / Imaging (Zoom, pinch, crop, etc) Dependencies -->
        <script src="./pixi-viewport.js" type="text/javascript"></script>
        <script src="Low_Mag/LMSI.js"></script>
    </head>
    <!--Determines whether Mouse Button is down or not using jQuery (this is for Multi-block)-->
    <script>
    var down = false;
    $(document).mousedown(function() {
            down = true;
        }).mouseup(function() {
            down = false;  
        });
    </script>
    <body>
        
        <!--Main javascript method-->
        <script>

            // Instantiate PIXI JS (from example)
            let type = "WebGL";
            if(!PIXI.utils.isWebGLSupported())
            {
                type = "canvas";
            }
            PIXI.utils.sayHello(type);

            let app = new PIXI.Application({ 
                    width: window.innerWidth,
                    height: window.innerHeight,
                    antialias: true,
                    transparent: false,
                    autoResize: true,
                    resolution: devicePixelRatio,
                    backgroundColor: 0x1099bb 
            });
    
            document.body.appendChild(app.view);
            window.addEventListener('resize', resize);
    
            function resize()
            {
                const parent = app.view.parentNode;
                app.renderer.resize(parent.clientWidth, parent.clientHeight);
            }

            var mouseData = app.renderer.plugins.interaction.mouse.global; // Change to pointer later (this is for multi-block)

            // Initially call updateActivity to start application
            updateActivity();

            // Initially draw the change activity button
            changeActivityButton();

            // updates the current activity (this is called from the createButton file)
            function updateActivity()
            {
                // clears the stage
                clear();

                // Logs the currentActivity (this variable is in globalVariables.js) (the function that this changes the currentActivity is in createButton.js in Multi-block // This is a temporary solution)
                console.log("Current Activity: " + currentActivity);

                // Everyone please updates these according to your code! - Jack
                if(currentActivity == 'Welcome')
                {
                    startLoginPage();
                }
                else if(currentActivity == 'Windows')
                {
                    // function in main.js in Windows folder
                    startWindows();
                }
                else if(currentActivity == 'Zoom')
                {
                    // Low_Mag/LMSI.js
                    // LSMI();
                }
                else if(currentActivity == 'Multispectrum')
                {
                    Spectrum.startSpectrum();
                }
                else if(currentActivity == 'Tilting')
                {
                    //Tilting.startTilting();
                }
                else if(currentActivity == 'Multi-block')
                {
                    // this function is in main.js in Multi-block folder. This function generates the UI for my activity
                    startMultiblock();
                }
                else if(currentActivity == 'Line')
                {
                    LI_showAll();
                }

                // redraw the switch activity button when done drawing UI
                if(currentActivity != activityArray[activityArray.length - 1])
                {
                    changeActivityButton();
                }
            }

            function changeActivityButton()
            {
                // This button will be to switch activites (reference is in createButton.js in the folder Multi-block)
                var changeActivitesButton = new RectButton(app.screen.width - 80, app.screen.height / 2, 60, 60, 'switchActivity');

                // This creates the icon to switch activites
                var arrowImage = new PIXI.Sprite.fromImage('Images/arrow.png', true);
                arrowImage.height = 60;
                arrowImage.width = 60;
                arrowImage.x = app.screen.width - 80;
                arrowImage.y = app.screen.height / 2;
                arrowImage.alpha = 0.7;
                app.stage.addChild(arrowImage);
            }

            function clear()
            {
                for(var i = app.stage.children.length - 1; i > 0; i--)
                {
                    app.stage.removeChild(app.stage.children[i]);
                }
            }
        
        </script>
    </body>
</html>
